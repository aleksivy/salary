
Перем КонтролироватьПорядок Экспорт;

// Процедура, обработчик события "ПередЗаписью" объекта
//
Процедура ПередЗаписью(Отказ)
	
	Если ОбменДанными.Загрузка Тогда
		Возврат;
	КонецЕсли; 
	
	Если НЕ Отказ И ПометкаУдаления И НЕ Владелец.ПометкаУдаления Тогда
		Если Владелец.ГруппаВходящие = Ссылка Тогда
			Сообщить(НСтр("ru='Группа является группой входящих писем по умолчанию для учетной записи ';uk='Група є групою вхідних листів по умовчанню для облікового запису '") + СокрЛП(Владелец) + НСтр("ru='. Установка пометки на удаление - запрещена.';uk='. Встановлення позначки для вилучення - заборонено.'"));
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаИсходящие = Ссылка Тогда
			Сообщить(НСтр("ru='Группа является группой исходящих писем по умолчанию для учетной записи ';uk='Група є групою вихідних листів по умовчанню для облікового запису '") + СокрЛП(Владелец) + НСтр("ru='. Установка пометки на удаление - запрещена.';uk='. Встановлення позначки для вилучення - заборонено.'"));
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаУдаленные = Ссылка Тогда
			Сообщить(НСтр("ru='Группа является группой удаленных писем по умолчанию для учетной записи ';uk='Група є групою вилучених листів по умовчанню для облікового запису '") + СокрЛП(Владелец) + НСтр("ru='. Установка пометки на удаление - запрещена.';uk='. Встановлення позначки для вилучення - заборонено.'"));
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаЧерновики = Ссылка Тогда
			Сообщить(НСтр("ru='Группа является группой черновых писем по умолчанию для учетной записи ';uk='Група є групою чорнових листів за замовчуванням для облікового запису '") + СокрЛП(Владелец) + НСтр("ru='. Установка пометки на удаление - запрещена.';uk='. Встановлення позначки для вилучення - заборонено.'"));
			Отказ = Истина;
		ИначеЕсли Владелец.ГруппаНежелательные = Ссылка Тогда
			Сообщить(НСтр("ru='Группа является группой нежелательных писем по умолчанию для учетной записи ';uk='Група є групою небажаних листів по умовчанню для облікового запису '") + СокрЛП(Владелец) + НСтр("ru='. Установка пометки на удаление - запрещена.';uk='. Встановлення позначки для вилучення - заборонено.'"));
			Отказ = Истина;
		КонецЕсли;
	КонецЕсли; 
	
	Если НЕ Отказ Тогда
		ОбщегоНазначения.ПередЗаписьюОбъектаПорядка(Отказ, ЭтотОбъект, КонтролироватьПорядок);
	КонецЕсли; 
	
КонецПроцедуры

КонтролироватьПорядок = Истина;
