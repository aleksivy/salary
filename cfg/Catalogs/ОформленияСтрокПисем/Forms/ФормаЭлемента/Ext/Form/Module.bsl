
Процедура ПриОткрытии()
	
	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);	
	
	// цвет текста
	ТекущийЦвет = ЦветТекста.Получить();
	
	Если ТипЗнч(ТекущийЦвет) <> Тип("Цвет") Тогда
		ТекущийЦвет = Новый Цвет();
	КонецЕсли;
	
	ЭлементыФормы.ЦветТекста.ЦветФона = ТекущийЦвет;
	
	// цвет фона
	ТекущийЦвет = ЦветФона.Получить();
	
	Если ТипЗнч(ТекущийЦвет) <> Тип("Цвет") Тогда
		ТекущийЦвет = Новый Цвет();
	КонецЕсли;
	
	ЭлементыФормы.ЦветФона.ЦветФона = ТекущийЦвет;
	
КонецПроцедуры

Процедура ЦветТекстаНажатие(Элемент)
	
	ТекущийЦвет = ЦветТекста.Получить();
	
	Если ТипЗнч(ТекущийЦвет) <> Тип("Цвет") Тогда
		ТекущийЦвет = Новый Цвет();
	КонецЕсли;
	
	Диалог = Новый ДиалогВыбораЦвета;
	
	Диалог.Цвет = ТекущийЦвет;
	
	Диалог.Выбрать();
	
	ВыбранныйЦвет = Диалог.Цвет;
	
	Если ЦветТекста <> ВыбранныйЦвет Тогда
		Хранилище = Новый ХранилищеЗначения(ВыбранныйЦвет);
		ЦветТекста = Хранилище;
	КонецЕсли;
	
	ЭлементыФормы.ЦветТекста.ЦветФона = ВыбранныйЦвет;
	
КонецПроцедуры

Процедура ЦветФонаНажатие(Элемент)
	
	ТекущийЦвет = ЦветФона.Получить();
	
	Если ТипЗнч(ТекущийЦвет) <> Тип("Цвет") Тогда
		ТекущийЦвет = Новый Цвет();
	КонецЕсли;
	
	Диалог = Новый ДиалогВыбораЦвета;
	
	Диалог.Цвет = ТекущийЦвет;
	
	Диалог.Выбрать();
	
	ВыбранныйЦвет = Диалог.Цвет;
	
	Если ЦветФона <> ВыбранныйЦвет Тогда
		Хранилище = Новый ХранилищеЗначения(ВыбранныйЦвет);
		ЦветФона = Хранилище;
	КонецЕсли;
	
	ЭлементыФормы.ЦветФона.ЦветФона = ВыбранныйЦвет;

КонецПроцедуры

Процедура ДействияФормыРедактироватьКод(Кнопка)
	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);
КонецПроцедуры
