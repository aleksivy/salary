
Процедура ПредметНачалоВыбораИзСписка(Элемент, СтандартнаяОбработка)
	
	Запрос = Новый Запрос;
	
	Запрос.Текст = "
	|ВЫБРАТЬ РАЗЛИЧНЫЕ РАЗРЕШЕННЫЕ
	|	ПредметыЭлектронныхПисем.Предмет
	|ИЗ
	|	РегистрСведений.ПредметыЭлектронныхПисем КАК ПредметыЭлектронныхПисем
	|ГДЕ
	|	НЕ ПредметыЭлектронныхПисем.Предмет В(&ПустойСписок)
	|	" + ?(ЗначениеЗаполнено(ГруппаУчетнойЗаписи), "И
	|	ПредметыЭлектронныхПисем.ГруппаПисемЭлектроннойПочты = &ВыбГруппа", "") + "
	|	" + ?(ЗначениеЗаполнено(УчетнаяЗапись), "И
	|	ПредметыЭлектронныхПисем.ГруппаПисемЭлектроннойПочты.Владелец = &ВыбУчетнаяЗапись", "") + "
	|УПОРЯДОЧИТЬ ПО
	|	ПредметыЭлектронныхПисем.Предмет ВОЗР
	|";
	
	Запрос.УстановитьПараметр("ВыбГруппа"       , ГруппаУчетнойЗаписи);
	Запрос.УстановитьПараметр("ВыбУчетнаяЗапись", УчетнаяЗапись);
	МассивТипов = Метаданные.Документы.ЭлектронноеПисьмо.Реквизиты.ПредметКонтакта.Тип.Типы();
	ПустойСписок = Новый СписокЗначений;
	Для каждого ТипСписка Из МассивТипов Цикл
		ПустойСписок.Добавить(ОбщегоНазначения.ПустоеЗначениеТипа(ТипСписка));
	КонецЦикла; 
	Запрос.УстановитьПараметр("ПустойСписок", ПустойСписок);
	
	Элемент.СписокВыбора.Очистить();
	Выборка = Запрос.Выполнить().Выбрать();
	Пока Выборка.Следующий() Цикл
		Элемент.СписокВыбора.Добавить(Выборка.Предмет);
	КонецЦикла; 
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	мПоследнееЗначениеЭлементаТайпингаПредмет = Предмет;
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОК(Кнопка)
	
	ЭтаФорма.Закрыть(Предмет);
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОтмена(Кнопка)
	
	ЭтаФорма.Закрыть();
	
КонецПроцедуры
