////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ КОМАНДНОЙ ПАНЕЛИ ФОРМЫ

// Процедура формирует документ "Отсутствие на работе".
Процедура ДействияФормыОтсутствиеНаРаботе(Кнопка)
	
	Если ЭлементыФормы.РаботникиОрганизации.ТекущаяСтрока = Неопределено Тогда
		Возврат
	КонецЕсли;
	
	НовыйДокумент = Документы.ОтсутствиеНаРаботе.СоздатьДокумент();
	ЗаполнениеДокументов.ЗаполнитьШапкуДокумента(НовыйДокумент);
	НоваяСтрока = НовыйДокумент.Работники.Добавить();
	НоваяСтрока.ФизЛицо	   = ЭлементыФормы.РаботникиОрганизации.ТекущаяСтрока.ФизЛицо;
	НоваяСтрока.ДатаНачала = РабочаяДата;
	НовыйДокумент.ПолучитьФорму().Открыть();
	
КонецПроцедуры

// Процедура формирует документ "Возврат на работу".
Процедура ДействияФормыВозвратНаРаботу(Кнопка)
	
	Если ЭлементыФормы.РаботникиОрганизации.ТекущаяСтрока = Неопределено Тогда
		Возврат
	КонецЕсли;
	
	НовыйДокумент = Документы.ВозвратНаРаботу.СоздатьДокумент();
	ЗаполнениеДокументов.ЗаполнитьШапкуДокумента(НовыйДокумент);
	НоваяСтрока = НовыйДокумент.Работники.Добавить();
	НоваяСтрока.ФизЛицо	     = ЭлементыФормы.РаботникиОрганизации.ТекущаяСтрока.ФизЛицо;
	НоваяСтрока.ДатаВозврата = РабочаяДата;
	НовыйДокумент.ПолучитьФорму().Открыть();
	
КонецПроцедуры

// Процедура открывает форму списка регистра. 
Процедура ДействияФормыИстория(Кнопка)
	
	Если Кнопка.Пометка Тогда
		Кнопка.Пометка = Ложь;
		ЭлементыФормы.РаботникиОрганизации.ВыбиратьСрез = ИспользованиеСреза.Последние;
	Иначе
		Кнопка.Пометка = Истина;
		ЭлементыФормы.РаботникиОрганизации.ВыбиратьСрез = ИспользованиеСреза.НеИспользовать;
	КонецЕсли;
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	ЭлементыФормы.ДействияФормы.Кнопки.История.Пометка = Истина;

КонецПроцедуры

Процедура РаботникиОрганизацииВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	Если не ЭлементыФормы.ДействияФормы.Кнопки.История.Пометка Тогда
		ВыбраннаяСтрока.Физлицо.ПолучитьФорму().Открыть();
		СтандартнаяОбработка = Ложь;
	КонецЕсли;

КонецПроцедуры





